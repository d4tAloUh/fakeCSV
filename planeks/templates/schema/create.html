{% extends 'generic_with_jquery.html' %}

{% block content %}
    <div class="container">
        <h2>{% block form_title %}New Schema{% endblock %}</h2>
        <form method="post">
            {% csrf_token %}
            <label for="id_schema_name">Schema name:</label>
            <input type="text" name="schema_name" value="{{ schema.schema_name }}"
                   maxlength="255" required id="id_schema_name">

            <label for="id_column_separator">Column separator:</label>
            <select name="column_separator" required id="id_column_separator">
                {% for column_char, value in schema.COLUMN_SEPARATOR_CHOICE %}
                    <option value="{{ column_char }}"
                            {% if column_char == schema.column_separator %}selected {% endif %}>
                        {{ value }} ({{ column_char }})
                    </option>
                {% endfor %}

            </select>
            <label for="id_string_character">String character:</label>
            <select name="string_character" required
                    id="id_string_character">
                {% for string_char, value in schema.STRING_CHARACTER_CHOICE %}
                    <option value="{{ string_char }}"
                            {% if string_char == schema.string_character %}selected {% endif %}>
                        {{ value }} ({{ string_char }})
                    </option>
                {% endfor %}
            </select>

            <h3>Columns</h3>

            {% for column in schema.column_set.all %}
                <div class="schema_column">
                    <label for="id_name">Name:</label>
                    <input type="text" name="column_name.{{ column.id }}" value="{{ column.column_name }}"
                           maxlength="255" required=""
                           id="id_name">
                    <label for="id_column_type">Column type:</label>
                    <select name="column_type.{{ column.id }}" required id="id_column_type">
                        {% for type_string, value in column.TYPE_CHOICES %}
                            <option value="{{ type_string }}"
                                    {% if type_string == column.column_type %}selected {% endif %}>
                                {{ value }}
                            </option>
                        {% endfor %}

                    </select>
                    <label for="id_column_order">Column order:</label>
                    <input type="number" name="column_order.{{ column.id }}" value="{{ column.column_order }}" required
                           id="id_column_order">

                    {% if column.column_type == 'text' %}
                        <label for="id_column_to">Amount of sentences:</label>
                        <input type="number" name="column_to.{{ column.id }}" id="id_column_to"
                               value="{{ column.column_to }}">
                    {% endif %}

                    {% if column.column_type == 'integer' %}
                        <label for="id_column_from">Column from:</label>
                        <input type="number" name="column_from.{{ column.id }}" id="id_column_from"
                               value="{{ column.column_from }}">

                        <label for="id_column_to">Column to:</label>
                        <input type="number" name="column_to.{{ column.id }}" id="id_column_to"
                               value="{{ column.column_to }}">
                    {% endif %}


                    <button class="btn btn-danger deleteColumn">delete</button>
                </div>
            {% endfor %}
            <button class="btn btn-info">Append</button>
            <button type="submit" class="btn btn-primary">{% block button_title %}Create{% endblock %}</button>
        </form>
    </div>
{% endblock %}

{% block script %}
    {% load static %}
    <script src="{% static 'js/schema_helpers.js' %}" type="text/javascript"></script>
{#    <script type="text/javascript">#}
{##}
{#    </script>#}
{% endblock %}